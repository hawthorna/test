<!DOCTYPE html>
<html lang="ms">
<head>
  <meta charset="UTF-8">
  <title>Pendaftaran Pesakit Psikiatri Forensik</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <div class="container">
    <h2>Borang Pendaftaran Pesakit Psikiatri Forensik</h2>
    <form id="forensikForm">
      <label>Nama</label><input name="nama" type="text" required>
      <label>No. Kad Pengenalan</label><input name="nokp" type="text" required>
      <label>Tarikh Lahir</label><input name="dob" type="date" required>
      <label>Umur</label><input name="umur" type="number" readonly>
      
      <label>Jantina</label>
      <select name="jantina" required>
        <option value="">-- Pilih --</option>
        <option value="Lelaki">Lelaki</option>
        <option value="Perempuan">Perempuan</option>
      </select>

      <label>Tarikh Booking</label>
      <input name="tarikh_booking" type="date" id="bookingDate" required>

      <label>Kewarasan</label>
      <select name="kewarasan">
        <option value="Waras">Waras</option>
        <option value="Tidak Waras">Tidak Waras</option>
      </select>

      <label>Fitness</label>
      <select name="fitness">
        <option value="Fit">Fit</option>
        <option value="Unfit">Unfit</option>
      </select>

      <label>Catatan</label>
      <textarea name="catatan"></textarea>

      <button type="submit">Hantar</button>
    </form>
  </div>

  <script src="script.js"></script>

  document.addEventListener('DOMContentLoaded', function () {
  const dobInput = document.querySelector('input[name="dob"]');
  const umurInput = document.querySelector('input[name="umur"]');
  const bookingDateInput = document.getElementById('bookingDate');

  // Isi tarikh hari ini secara automatik
  const today = new Date().toISOString().split('T')[0];
  bookingDateInput.value = today;

  // Kira umur secara automatik bila tarikh lahir dipilih
  dobInput.addEventListener('change', function () {
    const birthDate = new Date(this.value);
    const today = new Date();
    let age = today.getFullYear() - birthDate.getFullYear();
    const m = today.getMonth() - birthDate.getMonth();
    if (m < 0 || (m === 0 && today.getDate() < birthDate.getDate())) {
      age--;
    }
    umurInput.value = age;
  });

  // Submit borang ke Google Apps Script
  document.getElementById('forensikForm').addEventListener('submit', function(e) {
    e.preventDefault();
    const data = Object.fromEntries(new FormData(this).entries());

    fetch('URL_WEB_APP', { // Gantikan URL_WEB_APP dengan URL sebenar anda
      method: 'POST',
      body: JSON.stringify(data),
      headers: { 'Content-Type': 'application/json' }
    })
    .then(res => res.json())
    .then(res => {
      if (res.result === "success") {
        alert("Pendaftaran berjaya.");
        this.reset();
        bookingDateInput.value = today;
      } else {
        alert("Ralat ketika menghantar data.");
      }
    });
  });
});


 body {
  font-family: Arial, sans-serif;
  background: #f4f4f4;
  padding: 20px;
}
.container {
  background: white;
  padding: 20px;
  border-radius: 10px;
  max-width: 700px;
  margin: auto;
}
label {
  display: block;
  margin-top: 10px;
}
input, select, textarea {
  width: 100%;
  padding: 8px;
  margin-top: 5px;
  border-radius: 5px;
  border: 1px solid #ccc;
}
button {
  margin-top: 20px;
  padding: 10px 20px;
  background: #0066cc;
  color: white;
  border: none;
  border-radius: 5px;
  cursor: pointer;
}
</body>
</html>
